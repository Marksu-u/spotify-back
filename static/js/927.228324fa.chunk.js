"use strict";(self.webpackChunkspotify_back=self.webpackChunkspotify_back||[]).push([[927,62],{927:(t,e,a)=>{a.r(e),a.d(e,{default:()=>w});var s=a(791),r=a(907),o=a(183),n=a(144),i=a(835),c=a(184);const d=(0,s.lazy)((()=>a.e(828).then(a.bind(a,828)))),l=(0,s.lazy)((()=>a.e(839).then(a.bind(a,839)))),u=(0,s.lazy)((()=>a.e(275).then(a.bind(a,275)))),b=(0,s.lazy)((()=>a.e(320).then(a.bind(a,320)))),w=t=>{let{items:e,type:a}=t;const[w,m]=(0,s.useState)(1),[y,h]=(0,s.useState)(""),j=(0,s.useMemo)((()=>e.filter((t=>{const e=!!t.title&&t.title.toLowerCase().includes(y.toLowerCase()),a=!!t.artist&&t.artist.toLowerCase().includes(y.toLowerCase());return e||a}))),[e,y]),f=Math.ceil(j.length/4),g=(0,s.useMemo)((()=>{const t=4*(w-1);return j.slice(t,t+4)}),[w,j]);console.log("ITEMS : ",g);const p=(0,s.useMemo)((()=>(0,c.jsx)(s.Suspense,{fallback:(0,c.jsx)(i.Z,{}),children:g.map((t=>(0,c.jsx)(d,{data:t,type:a},t._id)))})),[g,a]),x=()=>m((t=>Math.max(t-1,1))),S=()=>m((t=>Math.min(t+1,f)));return(0,c.jsxs)("div",{children:[(0,c.jsx)("div",{children:(0,c.jsx)(b,{onSearchChange:t=>{h(t),m(1)}})}),(0,c.jsx)(u,{currentPage:w,totalPages:f,onPrevious:x,onNext:S}),p,(0,c.jsx)(l,{type:a,onAdd:async(t,e)=>{try{switch(console.log("newData :",t),e){case"artist":await o.E.createArtist(t);const e=await o.E.getLastArtist(),a={id:e._id,name:e.title};delete a._id,await(0,n.xY)(a);break;case"song":await o.E.uploadAudio(t);break;case"album":await o.E.createAlbum(t);break;case"admin":await o.E.addAdmin(t)}r.B.notify("Ajout r\xe9ussie","success")}catch(a){console.error("Erreur lors de l'ajout de l'\xe9l\xe9ment :",a)}}}),(0,c.jsx)(u,{currentPage:w,totalPages:f,onPrevious:x,onNext:S})]})}},144:(t,e,a)=>{a.d(e,{Fk:()=>d,OX:()=>r,aS:()=>o,fC:()=>i,rU:()=>l,xD:()=>n,xY:()=>c});const s=()=>new Promise(((t,e)=>{const a=indexedDB.open("mk-bospot",1);a.onupgradeneeded=t=>{const e=t.target.result;e.createObjectStore("audios",{keyPath:"_id"}),e.createObjectStore("artists",{keyPath:"_id"}),e.createObjectStore("albums",{keyPath:"_id"})},a.onerror=t=>{e("Database error: ".concat(t.target.errorCode))},a.onsuccess=e=>{t(e.target.result)}})),r=async t=>{const e=(await s()).transaction("audios","readwrite").objectStore("audios");for(let a of t)e.put(a)},o=async()=>{const t=(await s()).transaction("audios","readonly").objectStore("audios");return new Promise(((e,a)=>{const s=t.getAll();s.onerror=()=>{a("Failed to retrieve data from database.")},s.onsuccess=()=>{e(s.result)}}))},n=async t=>{const e=(await s()).transaction("artists","readwrite").objectStore("artists");for(let a of t)e.put(a)},i=async()=>{const t=(await s()).transaction("artists","readonly").objectStore("artists");return new Promise(((e,a)=>{const s=t.getAll();s.onerror=()=>{a("Failed to retrieve data from database.")},s.onsuccess=()=>{e(s.result)}}))},c=async t=>{(await s()).transaction("artists","readwrite").objectStore("artists").add(t)},d=async t=>{const e=(await s()).transaction("albums","readwrite").objectStore("albums");for(let a of t)e.put(a)},l=async()=>{const t=(await s()).transaction("albums","readonly").objectStore("albums");return new Promise(((e,a)=>{const s=t.getAll();s.onerror=()=>{a("Failed to retrieve data from database.")},s.onsuccess=()=>{e(s.result)}}))}}}]);
//# sourceMappingURL=927.228324fa.chunk.js.map